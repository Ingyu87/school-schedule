<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>가동초 스마트 스케줄러 2026</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;700&display=swap" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <link rel="stylesheet" href="css/style.css">
</head>
<body class="bg-[#f3f4f6] h-screen flex flex-col overflow-hidden">
    <!-- Top Bar -->
    <header class="bg-white border-b border-gray-200 z-30 shrink-0">
        <div class="max-w-[1800px] mx-auto px-4 h-14 flex items-center justify-between">
            <div class="flex items-center gap-2 mr-8">
                <i class="fa-solid fa-school text-indigo-600 text-xl"></i>
                <h1 class="text-lg font-bold text-gray-900 whitespace-nowrap">가동초 스마트 스케줄러 2026</h1>
                <span id="sync-indicator" class="text-xs px-2 py-1 rounded bg-gray-100 text-gray-500 ml-2">
                    <i class="fa-solid fa-cloud"></i> 대기중
                </span>
            </div>
            <div class="flex space-x-1 overflow-x-auto scrollbar-hide">
                <button onclick="switchTab('tab0')" id="btn-tab0" class="tab-btn active">0. 기초 설정 (통합)</button>
                <button onclick="switchTab('tab1')" id="btn-tab1" class="tab-btn">1. 시설 시간표</button>
                <button onclick="switchTab('tab2')" id="btn-tab2" class="tab-btn">2. 교과전담 교사별 시간표</button>
                <button onclick="switchTab('tab3')" id="btn-tab3" class="tab-btn">3. 학급 시간표</button>
            </div>
            <div class="flex items-center gap-2">
                <button onclick="resetAllData()" class="text-xs bg-red-50 text-red-600 px-3 py-1.5 rounded border border-red-200 hover:bg-red-100 font-bold">
                    <i class="fa-solid fa-exclamation-triangle mr-1"></i>전체 초기화
                </button>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="flex-1 overflow-y-auto p-4">
        <div class="max-w-[1800px] mx-auto space-y-6">
            <!-- TAB 0: 기초 설정 -->
            <div id="tab0" class="space-y-6">
                <!-- 사용 안내 -->
                <div class="bg-gradient-to-r from-blue-50 to-indigo-50 border border-indigo-200 rounded-lg p-4">
                    <div class="flex items-center justify-between cursor-pointer" onclick="toggleHelp('help-tab0')">
                        <div class="flex items-center gap-2">
                            <i class="fa-solid fa-circle-info text-indigo-600 text-xl"></i>
                            <h3 class="font-bold text-indigo-900">📘 사용 방법 (클릭하여 펼치기)</h3>
                        </div>
                        <i id="help-tab0-icon" class="fa-solid fa-chevron-down text-indigo-600"></i>
                    </div>
                    <div id="help-tab0" class="hidden mt-3 pt-3 border-t border-indigo-200 text-sm text-gray-700 space-y-2">
                        <p><strong class="text-indigo-700">📌 이 탭의 목적:</strong> 시간표 작성을 위한 기본 정보를 설정합니다.</p>
                        <div class="pl-4 space-y-1">
                            <p><strong>1단계:</strong> 각 학년의 학급 수를 입력하세요. (예: 4학년 4개반 → 4 입력)</p>
                            <p><strong>2단계:</strong> 교육과정 편제표는 기본값이 설정되어 있습니다. 필요시 수정하세요.</p>
                            <p><strong>3단계:</strong> 교과 시간 배당표에서 목표 시수를 확인하세요.</p>
                            <p><strong>4단계:</strong> 전담 교사가 담당할 과목을 추가하세요. (예: 4학년 영어 2시간)</p>
                            <p><strong>5단계:</strong> 특수 지원 과목이 있다면 추가하세요.</p>
                        </div>
                        <p class="text-indigo-600"><i class="fa-solid fa-lightbulb mr-1"></i><strong>완료 후:</strong> 상단의 "1단계 시설 시간표" 탭을 눌러 다음 단계로 이동하세요.</p>
                    </div>
                </div>

                <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                    <!-- 1. 학급 수 설정 -->
                    <div class="card">
                        <h2 class="text-lg font-bold text-gray-800 mb-4 flex items-center">
                            <i class="fa-solid fa-users-rectangle text-indigo-500 mr-2"></i>1. 학년별 학급 수 및 요일별 시수
                        </h2>
                        <table class="base-table mb-4">
                            <thead><tr><th>학년</th><th>월</th><th>화</th><th>수</th><th>목</th><th>금</th><th>계</th></tr></thead>
                            <tbody id="daily-counts-body"></tbody>
                        </table>
                        <div class="border-t pt-4">
                            <h3 class="text-sm font-bold text-gray-700 mb-2">학급 수 설정</h3>
                            <div class="grid grid-cols-6 gap-2" id="class-config-container"></div>
                        </div>
                    </div>
                    <!-- 2. 일과 운영표 -->
                    <div class="card">
                        <h2 class="text-lg font-bold text-gray-800 mb-4 flex items-center">
                            <i class="fa-solid fa-clock text-green-500 mr-2"></i>2. 일과 운영표
                        </h2>
                        <table class="base-table">
                            <thead><tr><th class="w-16">구분</th><th>1~3학년 (점심 먼저)</th><th>4~6학년 (수업 먼저)</th></tr></thead>
                            <tbody>
                                <tr><td>1교시</td><td>09:00 ~ 09:40</td><td>09:00 ~ 09:40</td></tr>
                                <tr><td>2교시</td><td>09:50 ~ 10:30</td><td>09:50 ~ 10:30</td></tr>
                                <tr><td>3교시</td><td>10:40 ~ 11:20</td><td>10:40 ~ 11:20</td></tr>
                                <tr><td class="font-bold text-indigo-700 bg-indigo-50">4교시</td><td class="font-bold text-indigo-700 bg-indigo-50">12:10 ~ 12:50<br><span class="text-xs font-normal text-gray-500">(점심 후)</span></td><td class="font-bold text-pink-700 bg-pink-50">11:30 ~ 12:10<br><span class="text-xs font-normal text-gray-500">(수업 후)</span></td></tr>
                                <tr><td class="font-bold text-gray-600 bg-gray-50">점심</td><td class="bg-gray-50">11:20 ~ 12:10</td><td class="bg-gray-50">12:10 ~ 13:00</td></tr>
                                <tr><td>5교시</td><td>13:00 ~ 13:40</td><td>13:00 ~ 13:40</td></tr>
                                <tr><td>6교시</td><td>13:50 ~ 14:30 (3학년~)</td><td>13:50 ~ 14:30</td></tr>
                            </tbody>
                        </table>
                    </div>
                </div>
                <!-- 3. 교육과정 시수표 -->
                <div class="card">
                    <div class="flex justify-between items-center mb-4">
                        <h2 class="text-lg font-bold text-gray-800 flex items-center"><i class="fa-solid fa-book text-pink-500 mr-2"></i>3. 학년별 교육과정 편제표 (주당 시수)</h2>
                        <span class="text-xs bg-indigo-50 text-indigo-700 px-2 py-1 rounded border border-indigo-100">✏️ 수정 시 자동 저장됩니다</span>
                    </div>
                    <div class="overflow-x-auto"><table class="base-table"><thead><tr><th>학년</th><th>국어</th><th>수학</th><th>사회</th><th>과학</th><th>영어</th><th>음악</th><th>미술</th><th>체육</th><th>실과</th><th>도덕</th><th>통합</th><th>창체</th><th class="bg-gray-100">계</th></tr></thead><tbody id="curriculum-body"></tbody></table></div>
                </div>
                <!-- 4. 교과 시간 배당표 -->
                <div class="card">
                    <h2 class="text-lg font-bold text-gray-800 mb-4 flex items-center">
                        <i class="fa-solid fa-calculator text-purple-500 mr-2"></i>4. 교과 시간 배당표
                    </h2>
                    <div class="overflow-x-auto">
                        <table class="base-table text-sm">
                            <thead>
                                <tr>
                                    <th class="bg-indigo-50 text-indigo-800">구분</th>
                                    <th id="th-1">1학년<br><span class="font-normal text-gray-500" id="cls-1"></span></th>
                                    <th id="th-2">2학년<br><span class="font-normal text-gray-500" id="cls-2"></span></th>
                                    <th id="th-3">3학년<br><span class="font-normal text-gray-500" id="cls-3"></span></th>
                                    <th id="th-4">4학년<br><span class="font-normal text-gray-500" id="cls-4"></span></th>
                                    <th id="th-5">5학년<br><span class="font-normal text-gray-500" id="cls-5"></span></th>
                                    <th id="th-6">6학년<br><span class="font-normal text-gray-500" id="cls-6"></span></th>
                                </tr>
                            </thead>
                            <tbody id="time-allocation-body"></tbody>
                        </table>
                    </div>
                </div>

                <!-- 5. 학년별 교과전담 -->
                <div class="card">
                    <div class="flex justify-between items-center mb-4">
                        <h2 class="text-lg font-bold text-gray-800 flex items-center">
                            <i class="fa-solid fa-chalkboard-user text-blue-500 mr-2"></i>5. 학년별 공통 전담 과목 선택
                        </h2>
                        <span class="text-xs text-gray-500">위 4번 배당표의 목표 시수에 맞게 과목을 추가하세요.</span>
                    </div>
                    <div class="overflow-x-auto">
                        <table class="w-full text-sm border-collapse">
                            <thead class="bg-gray-50 text-gray-700">
                                <tr>
                                    <th class="p-2 border text-center w-20">학년</th>
                                    <th class="p-2 border text-center w-24">현재/목표</th>
                                    <th class="p-2 border text-left">전담 과목 목록</th>
                                    <th class="p-2 border text-center w-64">과목 추가</th>
                                </tr>
                            </thead>
                            <tbody id="common-alloc-body"></tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- TAB 1: 시설 시간표 -->
            <div id="tab1" class="hidden space-y-4">
                <!-- 사용 안내 -->
                <div class="bg-gradient-to-r from-orange-50 to-amber-50 border border-orange-200 rounded-lg p-4">
                    <div class="flex items-center justify-between cursor-pointer" onclick="toggleHelp('help-tab1')">
                        <div class="flex items-center gap-2">
                            <i class="fa-solid fa-circle-info text-orange-600 text-xl"></i>
                            <h3 class="font-bold text-orange-900">📘 사용 방법 (클릭하여 펼치기)</h3>
                        </div>
                        <i id="help-tab1-icon" class="fa-solid fa-chevron-down text-orange-600"></i>
                    </div>
                    <div id="help-tab1" class="hidden mt-3 pt-3 border-t border-orange-200 text-sm text-gray-700 space-y-2">
                        <p><strong class="text-orange-700">📌 이 탭의 목적:</strong> 체육관과 도서관 사용 시간을 먼저 배정합니다.</p>
                        <div class="pl-4 space-y-1">
                            <p><strong>입력 방법:</strong> 셀을 클릭하고 <strong>숫자를 직접 입력</strong>하세요. (예: <code class="bg-white px-1 rounded">41</code> 입력 → 자동으로 <code class="bg-white px-1 rounded">4-1</code>)</p>
                            <p><strong>격주 배정:</strong> 쉼표 또는 스페이스로 구분하세요. (예: <code class="bg-white px-1 rounded">41,42</code> 또는 <code class="bg-white px-1 rounded">41 42</code> → <code class="bg-white px-1 rounded">4-1/4-2</code>)</p>
                            <p><strong>4교시 주의:</strong> 분홍색(1~3학년), 파란색(4~6학년) 행을 구분해서 입력하세요.</p>
                            <p><strong>편집 기능:</strong> 화살표 키로 이동, Ctrl+C/V로 복사/붙여넣기, 드래그로 이동 가능</p>
                            <p class="text-xs text-orange-600">💡 <strong>이 탭만 숫자 직접 입력 방식입니다!</strong> 나머지 탭은 모두 버튼 클릭 방식입니다.</p>
                        </div>
                        <p class="text-orange-600"><i class="fa-solid fa-lightbulb mr-1"></i><strong>완료 후:</strong> "2단계 전담 교사 시간표" 탭으로 이동하세요.</p>
                    </div>
                </div>

                <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                    <div class="card">
                        <div class="flex justify-between items-center mb-3">
                            <h3 class="font-bold text-gray-800"><i class="fa-solid fa-basketball text-orange-500 mr-2"></i>느티홀 (체육관)</h3>
                            <div class="flex items-center gap-2">
                                <span class="text-xs text-gray-400">반 입력 (예: 6-1) | 격주: 3-1,4-1 (쉼표로 구분)</span>
                                <button onclick="resetFacility('gym')" class="text-xs text-red-500 hover:text-red-700 hover:bg-red-50 px-2 py-1 rounded">
                                    <i class="fa-solid fa-rotate-left mr-1"></i>초기화
                                </button>
                            </div>
                        </div>
                        <table class="base-table"><thead><tr><th class="w-16">교시</th><th>월</th><th>화</th><th>수</th><th>목</th><th>금</th></tr></thead><tbody id="gym-grid"></tbody></table>
                    </div>
                    <div class="card">
                        <div class="flex justify-between items-center mb-3">
                            <h3 class="font-bold text-gray-800"><i class="fa-solid fa-book-open text-green-600 mr-2"></i>글샘터 (도서관)</h3>
                            <div class="flex items-center gap-2">
                                <span class="text-xs text-gray-400">반 입력 (예: 4-3) | 격주: 5-1,6-1 (쉼표로 구분)</span>
                                <button onclick="resetFacility('lib')" class="text-xs text-red-500 hover:text-red-700 hover:bg-red-50 px-2 py-1 rounded">
                                    <i class="fa-solid fa-rotate-left mr-1"></i>초기화
                                </button>
                            </div>
                        </div>
                        <table class="base-table"><thead><tr><th class="w-16">교시</th><th>월</th><th>화</th><th>수</th><th>목</th><th>금</th></tr></thead><tbody id="lib-grid"></tbody></table>
                    </div>
                </div>
            </div>

            <!-- TAB 2: 교과전담 교사 시간표 -->
            <div id="tab2" class="hidden space-y-6">
                <!-- 사용 안내 -->
                <div class="bg-gradient-to-r from-purple-50 to-pink-50 border border-purple-200 rounded-lg p-4">
                    <div class="flex items-center justify-between cursor-pointer" onclick="toggleHelp('help-tab2')">
                        <div class="flex items-center gap-2">
                            <i class="fa-solid fa-circle-info text-purple-600 text-xl"></i>
                            <h3 class="font-bold text-purple-900">📘 사용 방법 (클릭하여 펼치기)</h3>
                        </div>
                        <i id="help-tab2-icon" class="fa-solid fa-chevron-down text-purple-600"></i>
                    </div>
                    <div id="help-tab2" class="hidden mt-3 pt-3 border-t border-purple-200 text-sm text-gray-700 space-y-2">
                        <p><strong class="text-purple-700">📌 이 탭의 목적:</strong> 전담 교사를 추가하고 담당 과목과 시간표를 작성합니다.</p>
                        <div class="pl-4 space-y-1">
                            <p><strong>1단계:</strong> "교사 추가" 버튼을 눌러 전담 교사를 추가하세요.</p>
                            <p><strong>2단계:</strong> 교사 이름을 입력하세요.</p>
                            <p><strong>3단계:</strong> 과목 배정 버튼을 <strong>클릭</strong>하여 담당 학급과 과목을 선택하세요. (목표: 21시간)</p>
                            <p><strong>4단계:</strong> "시간표" 버튼을 눌러 시간표 모달을 여세요.</p>
                            <p><strong>5단계 (시간표 입력):</strong> 모달 오른쪽에서 <strong>"반-과목" 버튼을 클릭</strong>하세요. (예: "4-1 영어" 버튼)</p>
                            <p><strong>6단계:</strong> 선택한 반-과목이 활성화되면, 시간표 셀을 <strong>클릭</strong>하여 배정하세요.</p>
                            <p><strong>7단계:</strong> 시간표 완성 후 "완료" 체크박스를 선택하면 "저장" 버튼이 활성화됩니다.</p>
                            <p class="text-xs text-purple-600 font-bold">💡 <strong>삭제 방법:</strong> 셀을 클릭하거나 Delete 키를 누르면 삭제됩니다.</p>
                            <p class="text-xs text-gray-500">💡 <strong>주의:</strong> 시설 시간표와 달리 여기서는 숫자 직접 입력이 아닌 버튼 클릭 방식입니다! 격주 입력도 불가능합니다.</p>
                        </div>
                        <p class="text-purple-600"><i class="fa-solid fa-lightbulb mr-1"></i><strong>모든 전담 완료 후:</strong> "전체 전담 시간표" 버튼으로 전체 저장 가능</p>
                    </div>
                </div>

                <!-- 전담 교사 완료 현황판 -->
                <div class="card bg-gradient-to-r from-blue-50 to-indigo-50 border-blue-200">
                    <div class="flex justify-between items-center mb-3">
                        <h2 class="text-lg font-bold text-indigo-900 flex items-center">
                            <i class="fa-solid fa-clipboard-check text-blue-500 mr-2"></i>전담 교사 시간표 완료 현황
                        </h2>
                        <div id="teacher-completion-summary" class="text-sm font-bold"></div>
                    </div>
                    <div id="teacher-completion-panel" class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-2"></div>
                </div>

                <!-- 특수부장 지원 과목 설정 -->
                <div class="card">
                    <h2 class="text-lg font-bold text-gray-800 mb-4 flex items-center">
                        <i class="fa-solid fa-star text-yellow-500 mr-2"></i>특수부장 지원 과목 설정
                    </h2>
                    <p class="text-sm text-gray-500 mb-3">특수부장이 담당하는 추가 과목을 설정하세요. (학년-반-과목-시수)</p>
                    <div class="flex flex-wrap gap-2 mb-3" id="special-support-list"></div>
                    <div class="flex gap-2 items-center flex-wrap">
                        <select id="special-grade-sel" class="border rounded p-2 text-sm" onchange="updateSpecialClassOptions()">
                            <option value="">학년</option>
                            <option value="3">3학년</option>
                            <option value="4">4학년</option>
                            <option value="5">5학년</option>
                            <option value="6">6학년</option>
                        </select>
                        <select id="special-class-sel" class="border rounded p-2 text-sm">
                            <option value="">반</option>
                        </select>
                        <select id="special-subj-sel" class="border rounded p-2 text-sm">
                            <option value="">과목</option>
                        </select>
                        <input id="special-hrs-input" type="number" min="0.5" step="0.5" value="1" class="border rounded p-2 text-sm w-16 text-center" placeholder="시수">
                        <button onclick="addSpecialSupport()" class="bg-yellow-500 text-white px-3 py-2 rounded text-sm hover:bg-yellow-600">
                            <i class="fa-solid fa-plus mr-1"></i>추가
                        </button>
                    </div>
                </div>

                <!-- 전담 교사 설정 -->
                <div class="card bg-indigo-50 border-indigo-200">
                    <div class="flex flex-wrap justify-between items-center gap-4 mb-4">
                        <div>
                            <h2 class="text-lg font-bold text-indigo-900">전담 교사 과목 배정</h2>
                            <p class="text-sm text-indigo-700">학년 → 과목 → 담당 반을 선택하세요. (목표: 주 21시간)</p>
                        </div>
                        <div class="flex gap-2">
                            <button id="all-teachers-excel-btn" onclick="generateAllTeachersExcel()" disabled
                                    class="bg-blue-500 text-white px-4 py-2 rounded text-sm font-bold hover:bg-blue-600 disabled:bg-gray-300 disabled:cursor-not-allowed">
                                <i class="fa-solid fa-file-excel mr-1"></i>전체 전담 시간표
                            </button>
                        <button onclick="addTeacher()" class="bg-white border border-indigo-300 text-indigo-700 px-3 py-1.5 rounded text-sm hover:bg-indigo-100 font-bold shadow-sm">
                            <i class="fa-solid fa-user-plus mr-1"></i>교사 추가
                        </button>
                        </div>
                    </div>
                    <div id="teacher-setup-list" class="space-y-4"></div>
                </div>

            </div>

            <!-- TAB 3: 학급 시간표 -->
            <div id="tab3" class="hidden space-y-6">
                <!-- 사용 안내 -->
                <div class="bg-gradient-to-r from-green-50 to-teal-50 border border-green-200 rounded-lg p-4">
                    <div class="flex items-center justify-between cursor-pointer" onclick="toggleHelp('help-tab3')">
                        <div class="flex items-center gap-2">
                            <i class="fa-solid fa-circle-info text-green-600 text-xl"></i>
                            <h3 class="font-bold text-green-900">📘 사용 방법 (클릭하여 펼치기)</h3>
                        </div>
                        <i id="help-tab3-icon" class="fa-solid fa-chevron-down text-green-600"></i>
                    </div>
                    <div id="help-tab3" class="hidden mt-3 pt-3 border-t border-green-200 text-sm text-gray-700 space-y-2">
                        <p><strong class="text-green-700">📌 이 탭의 목적:</strong> 학급별로 담임 교사가 담당할 시간표를 작성합니다.</p>
                        <div class="pl-4 space-y-1">
                            <p><strong>1단계:</strong> 학년과 반을 선택하세요.</p>
                            <p><strong>2단계:</strong> 오른쪽 팔레트에서 <strong>과목 버튼을 클릭</strong>하세요. (분홍색: 전담 과목 우선 배정)</p>
                            <p><strong>3단계:</strong> 과목이 선택되면, 시간표 셀을 <strong>클릭</strong>하여 선택한 과목을 배정하세요.</p>
                            <p><strong>자동 차단:</strong> 시설 배정, 전담 교사 시간은 자동으로 입력 불가</p>
                            <p class="text-xs text-green-600 font-bold">💡 <strong>삭제 방법:</strong> 이미 입력된 셀을 다시 클릭하거나 Delete 키를 누르면 삭제됩니다.</p>
                            <p><strong>자동 채우기:</strong> 남은 시간을 자동으로 배정합니다.</p>
                            <p><strong>4단계:</strong> 완성 후 "완료" 체크박스를 선택하면 "저장" 버튼이 활성화됩니다.</p>
                            <p class="text-xs text-gray-500">💡 <strong>주의:</strong> 여기서도 숫자 직접 입력이 아닌 버튼 클릭 방식입니다! 격주 입력도 불가능합니다.</p>
                        </div>
                        <p class="text-red-600 font-bold"><i class="fa-solid fa-exclamation-triangle mr-1"></i><strong>⚠️ 중요:</strong> 모든 전담 교사 시간표가 완료되어야 이 탭에서 학급 시간표를 작성할 수 있습니다!</p>
                        <p class="text-green-600"><i class="fa-solid fa-lightbulb mr-1"></i><strong>모든 학급 완료 후:</strong> 하단의 "전교 기준 시간표 생성" 버튼으로 최종 엑셀 다운로드</p>
                    </div>
                </div>

                <div class="grid grid-cols-1 lg:grid-cols-4 gap-6 h-full">
                    <div class="lg:col-span-3 flex flex-col gap-4">
                        <div class="card flex-1 flex flex-col">
                            <div class="flex justify-between items-center mb-4">
                                <div class="flex items-center gap-3">
                                    <h2 class="text-lg font-bold text-gray-800">📅 학급 시간표</h2>
                                    <select id="editor-grade-select" onchange="onEditorGradeChange()" class="border-2 border-indigo-200 rounded px-2 py-1 text-sm font-bold text-indigo-700 outline-none focus:border-indigo-500">
                                        <option value="1학년">1학년</option>
                                        <option value="2학년">2학년</option>
                                        <option value="3학년">3학년</option>
                                        <option value="4학년">4학년</option>
                                        <option value="5학년">5학년</option>
                                        <option value="6학년">6학년</option>
                                    </select>
                                    <select id="editor-class-select" onchange="onEditorClassChange()" class="border-2 border-indigo-200 rounded px-3 py-1 text-lg font-bold text-indigo-700 outline-none focus:border-indigo-500"></select>
                                    <label id="class-completion-checkbox" class="flex items-center cursor-pointer bg-green-50 border border-green-300 px-3 py-1 rounded text-sm hover:bg-green-100 ml-2">
                                        <input type="checkbox" onchange="toggleClassCompletion()" class="mr-2" id="current-class-completed">
                                        <span class="text-green-700 font-bold">완료</span>
                                    </label>
                                </div>
                                <div class="space-x-2">
                                    <button onclick="resetClassTimetable()" class="bg-gray-100 text-gray-600 px-3 py-1.5 rounded text-sm font-bold hover:bg-gray-200"><i class="fa-solid fa-rotate-left mr-1"></i>초기화</button>
                                    <button onclick="autoFill()" class="bg-pink-100 text-pink-700 px-3 py-1.5 rounded text-sm font-bold hover:bg-pink-200"><i class="fa-solid fa-magic mr-1"></i>자동채우기</button>
                                    <button id="class-save-btn" onclick="downloadExcel()" disabled class="bg-green-600 text-white px-3 py-1.5 rounded text-sm font-bold hover:bg-green-700 disabled:bg-gray-300 disabled:cursor-not-allowed"><i class="fa-solid fa-file-excel mr-1"></i>저장</button>
                                </div>
                            </div>
                            <div class="flex-1 border rounded-lg overflow-hidden">
                                <table class="base-table w-full" style="table-layout: fixed;">
                                    <thead>
                                        <tr class="bg-gray-100">
                                            <th class="w-16 h-10">교시</th>
                                            <th class="h-10">월</th>
                                            <th class="h-10">화</th>
                                            <th class="h-10">수</th>
                                            <th class="h-10">목</th>
                                            <th class="h-10">금</th>
                                        </tr>
                                    </thead>
                                    <tbody id="editor-grid-body"></tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                    <div class="lg:col-span-1">
                        <div class="card h-full flex flex-col sticky top-0">
                            <h3 class="font-bold text-gray-800 mb-4 border-b pb-2">🎨 과목 팔레트</h3>
                            <div class="flex-1 overflow-y-auto pr-2 space-y-6">
                                <div><h4 class="text-xs font-bold text-pink-600 mb-2 uppercase flex justify-between">전담 과목 (우선) <i class="fa-solid fa-star"></i></h4><div id="palette-jeondam" class="space-y-1"></div></div>
                                <div><h4 class="text-xs font-bold text-gray-600 mb-2 uppercase">담임 과목 (나머지)</h4><div id="palette-damim" class="space-y-1"></div></div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- 학급 시간표 완료 현황판 (맨 아래로 이동) -->
                <div class="card bg-gradient-to-r from-green-50 to-emerald-50 border-green-200">
                    <div class="flex justify-between items-center mb-3">
                        <h2 class="text-lg font-bold text-emerald-900 flex items-center">
                            <i class="fa-solid fa-clipboard-check text-green-500 mr-2"></i>학급 시간표 완료 현황
                        </h2>
                        <div id="class-completion-summary" class="text-sm font-bold"></div>
                    </div>
                    <div id="class-completion-panel" class="space-y-2"></div>
                </div>

                <!-- 최종 엑셀 생성 버튼 (맨 아래로 이동) -->
                <div class="card bg-gradient-to-r from-purple-50 to-pink-50 border-purple-200">
                    <div class="flex justify-between items-center">
                        <div>
                            <h2 class="text-lg font-bold text-purple-900 flex items-center mb-2">
                                <i class="fa-solid fa-file-excel text-purple-500 mr-2"></i>최종 엑셀 생성
                            </h2>
                            <p class="text-sm text-purple-700">모든 전담 교사와 학급 시간표가 완료되면 전교 기준 시간표를 엑셀로 다운로드할 수 있습니다.</p>
                        </div>
                        <button id="final-excel-btn" onclick="generateFinalExcel()" disabled 
                                class="bg-purple-500 text-white px-6 py-3 rounded-lg text-lg font-bold hover:bg-purple-600 disabled:bg-gray-300 disabled:cursor-not-allowed shadow-lg">
                            <i class="fa-solid fa-download mr-2"></i>전교 기준 시간표 생성
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- JavaScript Files -->
    <script src="js/state.js"></script>
    <script src="js/utils.js"></script>
    <script src="js/firebase.js"></script>
    <script src="js/tab0.js"></script>
    <script src="js/tab1.js"></script>
    <script src="js/tab2.js"></script>
    <script src="js/tab3.js"></script>
    <script src="js/teacher-excel.js"></script>
    <script src="js/excel.js"></script>
    <script src="js/app.js"></script>
</body>
</html>
