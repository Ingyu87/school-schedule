<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title id="page-title">학교 스마트 스케줄러 2026</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;700&display=swap" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <link rel="stylesheet" href="css/style.css">
</head>
<body class="bg-[#f3f4f6] h-screen flex flex-col overflow-hidden">
    <!-- Top Bar -->
    <header class="bg-white border-b border-gray-200 z-30 shrink-0">
        <div class="max-w-[1800px] mx-auto px-4 h-14 flex items-center justify-between">
            <div class="flex items-center gap-2 mr-8">
                <i class="fa-solid fa-school text-indigo-600 text-xl"></i>
                <h1 class="text-lg font-bold text-gray-900 whitespace-nowrap"><span id="school-name-display">학교</span> 스마트 스케줄러 2026</h1>
                <span id="sync-indicator" class="text-xs px-2 py-1 rounded bg-gray-100 text-gray-500 ml-2">
                    <i class="fa-solid fa-cloud"></i> 대기중
                </span>
            </div>
            <div class="flex space-x-1 overflow-x-auto scrollbar-hide">
                <button onclick="switchTab('tab0')" id="btn-tab0" class="tab-btn active">0. 기초 설정 (통합)</button>
                <button onclick="switchTab('tab1')" id="btn-tab1" class="tab-btn">1. 시설 시간표</button>
                <button onclick="switchTab('tab2')" id="btn-tab2" class="tab-btn">2. 교과전담 교사별 시간표</button>
                <button onclick="switchTab('tab3')" id="btn-tab3" class="tab-btn">3. 학급 시간표</button>
            </div>
            <div class="flex items-center gap-2">
                <button onclick="checkAdminAccess()" class="text-xs bg-purple-100 text-purple-700 px-3 py-1.5 rounded border border-purple-200 hover:bg-purple-200 transition font-bold">
                    <i class="fa-solid fa-shield-halved mr-1"></i>관리자 페이지
                </button>
                <button onclick="logout()" class="text-xs bg-gray-100 text-gray-700 px-3 py-1.5 rounded border border-gray-200 hover:bg-gray-200 transition">
                    <i class="fa-solid fa-sign-out-alt mr-1"></i>로그아웃
                </button>
                <button onclick="resetAllData()" class="text-xs bg-red-50 text-red-600 px-3 py-1.5 rounded border border-red-200 hover:bg-red-100 font-bold">
                    <i class="fa-solid fa-exclamation-triangle mr-1"></i>전체 초기화
                </button>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="flex-1 overflow-y-auto p-4">
        <div class="max-w-[1800px] mx-auto space-y-6">
            <!-- TAB 0: 기초 설정 -->
            <div id="tab0" class="space-y-6">
                <!-- 사용 안내 -->
                <div class="bg-gradient-to-r from-blue-50 to-indigo-50 border border-indigo-200 rounded-lg p-4">
                    <div class="flex items-center justify-between cursor-pointer" onclick="toggleHelp('help-tab0')">
                        <div class="flex items-center gap-2">
                            <i class="fa-solid fa-circle-info text-indigo-600 text-xl"></i>
                            <h3 class="font-bold text-indigo-900">📘 사용 방법 (클릭하여 펼치기)</h3>
                        </div>
                        <i id="help-tab0-icon" class="fa-solid fa-chevron-down text-indigo-600"></i>
                    </div>
                    <div id="help-tab0" class="hidden mt-3 pt-3 border-t border-indigo-200 text-sm text-gray-700 space-y-3">
                        <p><strong class="text-indigo-700 text-base">📌 이 탭의 목적:</strong> 시간표 작성을 위한 기본 정보를 설정합니다. 모든 설정은 자동으로 저장됩니다.</p>
                        
                        <div class="bg-white rounded-lg p-4 border border-indigo-100 space-y-3">
                            <div>
                                <p class="font-bold text-indigo-800 mb-1">1️⃣ 학년별 학급 수 및 요일별 시수 설정</p>
                                <div class="pl-4 text-sm space-y-1">
                                    <p>• <strong>요일별 시수:</strong> 각 학년의 월~금요일별 수업 시수를 입력하세요. (예: 1학년 월요일 4교시)</p>
                                    <p>• <strong>학급 수:</strong> 각 학년의 학급 수를 입력하세요. (예: 4학년 4개반 → "4" 입력)</p>
                                    <p class="text-xs text-gray-500">💡 학급 수를 변경하면 시간표가 자동으로 초기화됩니다.</p>
                                </div>
                            </div>
                            
                            <div>
                                <p class="font-bold text-indigo-800 mb-1">2️⃣ 일과 운영표 설정</p>
                                <div class="pl-4 text-sm space-y-1">
                                    <p>• 각 교시의 시작/종료 시간을 입력하세요. (예: 09:00 ~ 09:40)</p>
                                    <p>• 1~3학년과 4~6학년의 시간표가 다를 수 있으니 각각 설정하세요.</p>
                                    <p>• 4교시는 점심 시간에 따라 다르게 설정됩니다.</p>
                                </div>
                            </div>
                            
                            <div>
                                <p class="font-bold text-indigo-800 mb-1">2-1️⃣ 시설 관리</p>
                                <div class="pl-4 text-sm space-y-1">
                                    <p>• <strong>기본 시설:</strong> 체육관과 도서관이 기본으로 설정되어 있습니다.</p>
                                    <p>• <strong>시설 추가:</strong> "시설 추가" 버튼을 클릭하여 추가 시설을 등록할 수 있습니다. (예: 과학실, 음악실 등)</p>
                                    <p>• <strong>시설 이름 변경:</strong> 각 시설의 이름을 원하는 대로 변경할 수 있습니다.</p>
                                    <p>• <strong>시설 삭제:</strong> 기본 시설(체육관, 도서관) 외의 시설은 삭제할 수 있습니다.</p>
                                    <p class="text-xs text-orange-600">⚠️ 시설에 배정된 시간은 전담 교사와 학급 시간표에서 자동으로 차단됩니다.</p>
                                </div>
                            </div>
                            
                            <div>
                                <p class="font-bold text-indigo-800 mb-1">3️⃣ 교육과정 편제표</p>
                                <div class="pl-4 text-sm space-y-1">
                                    <p>• 각 학년별 과목의 주당 시수를 입력하세요. (예: 4학년 국어 5시간)</p>
                                    <p>• 기본값이 설정되어 있지만, 학교 상황에 맞게 수정할 수 있습니다.</p>
                                    <p>• 수정하면 자동으로 저장됩니다.</p>
                                </div>
                            </div>
                            
                            <div>
                                <p class="font-bold text-indigo-800 mb-1">4️⃣ 교과 시간 배당표</p>
                                <div class="pl-4 text-sm space-y-1">
                                    <p>• 위에서 설정한 교육과정 시수를 기반으로 자동 계산됩니다.</p>
                                    <p>• <strong>교과전담 지원 시수:</strong> 전담 교사가 담당할 시수를 입력하세요. (예: 4학년 3시간)</p>
                                    <p>• <strong>보건 수업 지원:</strong> 보건 교사가 담당할 시수를 입력하세요. (예: 5학년 0.5시간)</p>
                                    <p>• 최종 담임 교사 수업 시수가 자동으로 계산됩니다.</p>
                                </div>
                            </div>
                            
                            <div>
                                <p class="font-bold text-indigo-800 mb-1">5️⃣ 학년별 공통 전담 과목 선택</p>
                                <div class="pl-4 text-sm space-y-1">
                                    <p>• <strong>과목 추가:</strong> 학년을 선택 → 과목 선택 → 시수 입력 → "추가" 버튼 클릭</p>
                                    <p>• 예: 4학년 영어 2시간 → "4학년" 선택 → "영어" 선택 → "2" 입력 → "추가" 클릭</p>
                                    <p>• <strong>과목 삭제:</strong> 추가된 과목 옆의 X 버튼을 클릭하세요.</p>
                                    <p>• 현재/목표 시수를 확인하여 목표 시수에 맞게 과목을 추가하세요.</p>
                                    <p class="text-xs text-gray-500">💡 보건은 전담 과목으로 추가할 수 없습니다. (시수만 반영)</p>
                                </div>
                            </div>
                            
                            <div>
                                <p class="font-bold text-indigo-800 mb-1">6️⃣ 전담 교사 설정</p>
                                <div class="pl-4 text-sm space-y-1">
                                    <p>• <strong>인원 수:</strong> 전담 교사 인원 수를 입력하세요. (1~20명)</p>
                                    <p>• <strong>이름:</strong> 각 교사의 이름을 입력하세요. (예: 김영어, 이과학)</p>
                                    <p>• <strong>목표 시수:</strong> 각 교사의 목표 수업 시수를 입력하세요. (기본: 21시간)</p>
                                    <p>• 이 설정은 2단계 탭(전담 교사 시간표)에 반영됩니다.</p>
                                </div>
                            </div>
                        </div>
                        
                        <div class="bg-indigo-50 rounded-lg p-3 border border-indigo-200">
                            <p class="text-indigo-800 font-bold mb-1"><i class="fa-solid fa-arrow-right mr-1"></i>다음 단계</p>
                            <p class="text-sm">모든 설정을 완료한 후, 상단의 <strong>"1. 시설 시간표"</strong> 탭을 클릭하여 다음 단계로 진행하세요.</p>
                        </div>
                    </div>
                </div>

                <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                    <!-- 1. 학급 수 설정 -->
                    <div class="card">
                        <h2 class="text-lg font-bold text-gray-800 mb-4 flex items-center">
                            <i class="fa-solid fa-users-rectangle text-indigo-500 mr-2"></i>1. 학년별 학급 수 및 요일별 시수
                        </h2>
                        <table class="base-table mb-4">
                            <thead><tr><th>학년</th><th>월</th><th>화</th><th>수</th><th>목</th><th>금</th><th>계</th></tr></thead>
                            <tbody id="daily-counts-body"></tbody>
                        </table>
                        <div class="border-t pt-4">
                            <h3 class="text-sm font-bold text-gray-700 mb-2">학급 수 설정</h3>
                            <div class="grid grid-cols-6 gap-2" id="class-config-container"></div>
                        </div>
                    </div>
                    <!-- 2. 일과 운영표 -->
                    <div class="card">
                        <h2 class="text-lg font-bold text-gray-800 mb-4 flex items-center">
                            <i class="fa-solid fa-clock text-green-500 mr-2"></i>2. 일과 운영표
                        </h2>
                        <table class="base-table">
                            <thead><tr><th class="w-16">구분</th><th>1~3학년 (점심 먼저)</th><th>4~6학년 (수업 먼저)</th></tr></thead>
                            <tbody id="schedule-times-body">
                                <!-- 동적으로 생성됨 -->
                            </tbody>
                        </table>
                    </div>
                </div>
                <!-- 2-1. 시설 이름 설정 -->
                <div class="card">
                    <div class="flex justify-between items-center mb-4">
                        <h2 class="text-lg font-bold text-gray-800 flex items-center">
                            <i class="fa-solid fa-building text-blue-500 mr-2"></i>2-1. 시설 관리
                        </h2>
                        <button onclick="addNewFacility()" class="text-xs bg-blue-500 text-white hover:bg-blue-600 px-3 py-1.5 rounded font-bold">
                            <i class="fa-solid fa-plus mr-1"></i>시설 추가
                        </button>
                    </div>
                    <div id="facility-list-container" class="space-y-3">
                        <!-- 동적으로 생성됨 -->
                    </div>
                </div>
                <!-- 3. 교육과정 시수표 -->
                <div class="card">
                    <div class="flex justify-between items-center mb-4">
                        <h2 class="text-lg font-bold text-gray-800 flex items-center"><i class="fa-solid fa-book text-pink-500 mr-2"></i>3. 학년별 교육과정 편제표 (주당 시수)</h2>
                        <span class="text-xs bg-indigo-50 text-indigo-700 px-2 py-1 rounded border border-indigo-100">✏️ 수정 시 자동 저장됩니다</span>
                    </div>
                    <div class="overflow-x-auto"><table class="base-table"><thead><tr><th>학년</th><th>국어</th><th>수학</th><th>사회</th><th>과학</th><th>영어</th><th>음악</th><th>미술</th><th>체육</th><th>실과</th><th>도덕</th><th>통합</th><th>창체</th><th class="bg-gray-100">계</th></tr></thead><tbody id="curriculum-body"></tbody></table></div>
                </div>
                <!-- 4. 교과 시간 배당표 -->
                <div class="card">
                    <h2 class="text-lg font-bold text-gray-800 mb-4 flex items-center">
                        <i class="fa-solid fa-calculator text-purple-500 mr-2"></i>4. 교과 시간 배당표
                    </h2>
                    <div class="overflow-x-auto">
                        <table class="base-table text-sm">
                            <thead>
                                <tr>
                                    <th class="bg-indigo-50 text-indigo-800">구분</th>
                                    <th id="th-1">1학년<br><span class="font-normal text-gray-500" id="cls-1"></span></th>
                                    <th id="th-2">2학년<br><span class="font-normal text-gray-500" id="cls-2"></span></th>
                                    <th id="th-3">3학년<br><span class="font-normal text-gray-500" id="cls-3"></span></th>
                                    <th id="th-4">4학년<br><span class="font-normal text-gray-500" id="cls-4"></span></th>
                                    <th id="th-5">5학년<br><span class="font-normal text-gray-500" id="cls-5"></span></th>
                                    <th id="th-6">6학년<br><span class="font-normal text-gray-500" id="cls-6"></span></th>
                                </tr>
                            </thead>
                            <tbody id="time-allocation-body"></tbody>
                        </table>
                    </div>
                </div>

                <!-- 5. 학년별 교과전담 -->
                <div class="card">
                    <div class="flex justify-between items-center mb-4">
                        <h2 class="text-lg font-bold text-gray-800 flex items-center">
                            <i class="fa-solid fa-chalkboard-user text-blue-500 mr-2"></i>5. 학년별 공통 전담 과목 선택
                        </h2>
                        <span class="text-xs text-gray-500">위 4번 배당표의 목표 시수에 맞게 과목을 추가하세요.</span>
                    </div>
                    <div class="overflow-x-auto">
                        <table class="w-full text-sm border-collapse">
                            <thead class="bg-gray-50 text-gray-700">
                                <tr>
                                    <th class="p-2 border text-center w-20">학년</th>
                                    <th class="p-2 border text-center w-24">현재/목표</th>
                                    <th class="p-2 border text-left">전담 과목 목록</th>
                                    <th class="p-2 border text-center w-64">과목 추가</th>
                                </tr>
                            </thead>
                            <tbody id="common-alloc-body"></tbody>
                        </table>
                    </div>
                </div>

                <!-- 6. 전담 교사 설정 -->
                <div class="card">
                    <div class="flex justify-between items-center mb-4">
                        <h2 class="text-lg font-bold text-gray-800 flex items-center">
                            <i class="fa-solid fa-user-tie text-purple-500 mr-2"></i>6. 전담 교사 설정
                        </h2>
                        <span class="text-xs text-gray-500">전담 교사 인원 수, 이름, 목표 시수를 설정하세요. (2단계 탭에 반영됩니다)</span>
                    </div>
                    <div class="space-y-4">
                        <div class="flex items-center gap-4">
                            <label class="text-sm font-bold text-gray-700">전담 교사 인원 수:</label>
                            <input type="number" min="1" max="20" value="${state.teacherConfig?.count || state.teachers.length}" 
                                   class="border rounded px-3 py-1 w-20 text-center font-bold" 
                                   onchange="updateTeacherCount(this.value)" id="teacher-count-input">
                        </div>
                        <div class="overflow-x-auto">
                            <table class="w-full text-sm border-collapse">
                                <thead class="bg-gray-50 text-gray-700">
                                    <tr>
                                        <th class="p-2 border text-center w-16">번호</th>
                                        <th class="p-2 border text-left">이름</th>
                                        <th class="p-2 border text-center w-24">목표 시수</th>
                                    </tr>
                                </thead>
                                <tbody id="teacher-config-body"></tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>

            <!-- TAB 1: 시설 시간표 -->
            <div id="tab1" class="hidden space-y-4">
                <!-- 사용 안내 -->
                <div class="bg-gradient-to-r from-orange-50 to-amber-50 border border-orange-200 rounded-lg p-4">
                    <div class="flex items-center justify-between cursor-pointer" onclick="toggleHelp('help-tab1')">
                        <div class="flex items-center gap-2">
                            <i class="fa-solid fa-circle-info text-orange-600 text-xl"></i>
                            <h3 class="font-bold text-orange-900">📘 사용 방법 (클릭하여 펼치기)</h3>
                        </div>
                        <i id="help-tab1-icon" class="fa-solid fa-chevron-down text-orange-600"></i>
                    </div>
                    <div id="help-tab1" class="hidden mt-3 pt-3 border-t border-orange-200 text-sm text-gray-700 space-y-3">
                        <p><strong class="text-orange-700 text-base">📌 이 탭의 목적:</strong> 시설(체육관, 도서관 등) 사용 시간을 먼저 배정합니다. 시설에 배정된 시간은 전담 교사와 학급 시간표에서 자동으로 차단됩니다.</p>
                        
                        <div class="bg-white rounded-lg p-4 border border-orange-100 space-y-3">
                            <div>
                                <p class="font-bold text-orange-800 mb-2">📝 기본 입력 방법 (이 탭만 숫자 직접 입력!)</p>
                                <div class="pl-4 text-sm space-y-2">
                                    <p><strong>1. 셀 클릭:</strong> 시간표의 셀을 클릭하세요.</p>
                                    <p><strong>2. 숫자 입력:</strong> 학년과 반을 숫자로 입력하세요.</p>
                                    <div class="bg-gray-50 p-2 rounded space-y-1">
                                        <p>• <strong>예시 1:</strong> <code class="bg-white px-2 py-1 rounded border">41</code> 입력 → 자동으로 <code class="bg-white px-2 py-1 rounded border">4-1</code>로 변환</p>
                                        <p>• <strong>예시 2:</strong> <code class="bg-white px-2 py-1 rounded border">63</code> 입력 → 자동으로 <code class="bg-white px-2 py-1 rounded border">6-3</code>로 변환</p>
                                    </div>
                                </div>
                            </div>
                            
                            <div>
                                <p class="font-bold text-orange-800 mb-2">🔄 격주 배정 방법 (같은 시간에 여러 반 배정)</p>
                                <div class="pl-4 text-sm space-y-2">
                                    <p>• <strong>쉼표로 구분:</strong> 여러 반을 쉼표(,)로 구분하여 입력하세요.</p>
                                    <p>• <strong>스페이스로 구분:</strong> 스페이스( )로도 구분할 수 있습니다.</p>
                                    <div class="bg-gray-50 p-2 rounded space-y-1">
                                        <p>• <strong>예시 1:</strong> <code class="bg-white px-2 py-1 rounded border">41,42</code> 입력 → <code class="bg-white px-2 py-1 rounded border">4-1/4-2</code>로 변환</p>
                                        <p>• <strong>예시 2:</strong> <code class="bg-white px-2 py-1 rounded border">51 52</code> 입력 → <code class="bg-white px-2 py-1 rounded border">5-1/5-2</code>로 변환</p>
                                        <p>• <strong>예시 3:</strong> <code class="bg-white px-2 py-1 rounded border">31,32,33</code> 입력 → <code class="bg-white px-2 py-1 rounded border">3-1/3-2/3-3</code>로 변환</p>
                                    </div>
                                    <p class="text-xs text-orange-600">💡 격주 배정은 시설 시간표에서만 가능합니다. 전담 교사와 학급 시간표에서는 불가능합니다.</p>
                                </div>
                            </div>
                            
                            <div>
                                <p class="font-bold text-orange-800 mb-2">⚠️ 4교시 주의사항</p>
                                <div class="pl-4 text-sm space-y-1">
                                    <p>• <strong>분홍색 행 (4교시 1~3학년):</strong> 1학년, 2학년, 3학년만 입력하세요.</p>
                                    <p>• <strong>파란색 행 (4교시 4~6학년):</strong> 4학년, 5학년, 6학년만 입력하세요.</p>
                                    <p>• 잘못 입력하면 경고 메시지가 표시됩니다.</p>
                                </div>
                            </div>
                            
                            <div>
                                <p class="font-bold text-orange-800 mb-2">⌨️ 편집 기능</p>
                                <div class="pl-4 text-sm space-y-1">
                                    <p>• <strong>화살표 키:</strong> 셀 간 이동 (↑↓←→)</p>
                                    <p>• <strong>복사/붙여넣기:</strong> Ctrl+C (복사), Ctrl+V (붙여넣기)</p>
                                    <p>• <strong>드래그 앤 드롭:</strong> 셀을 드래그하여 다른 셀로 이동</p>
                                    <p>• <strong>삭제:</strong> 셀을 선택하고 Delete 키 또는 Backspace 키</p>
                                </div>
                            </div>
                            
                            <div>
                                <p class="font-bold text-orange-800 mb-2">🏢 시설 추가/삭제</p>
                                <div class="pl-4 text-sm space-y-1">
                                    <p>• <strong>시설 추가:</strong> 0번 탭의 "시설 관리" 섹션에서 "시설 추가" 버튼을 클릭하세요.</p>
                                    <p>• <strong>시설 이름 변경:</strong> 0번 탭에서 각 시설의 이름을 수정할 수 있습니다.</p>
                                    <p>• <strong>시설 삭제:</strong> 기본 시설(체육관, 도서관) 외의 시설은 삭제할 수 있습니다.</p>
                                    <p>• 추가된 시설도 동일한 방법으로 시간표를 작성할 수 있습니다.</p>
                                </div>
                            </div>
                            
                            <div>
                                <p class="font-bold text-orange-800 mb-2">💾 저장 및 초기화</p>
                                <div class="pl-4 text-sm space-y-1">
                                    <p>• <strong>저장:</strong> 각 시설의 "저장" 버튼을 클릭하면 엑셀 파일로 다운로드됩니다.</p>
                                    <p>• <strong>초기화:</strong> "초기화" 버튼을 클릭하면 해당 시설의 시간표가 모두 지워집니다.</p>
                                    <p>• 모든 데이터는 자동으로 저장되므로 별도 저장 버튼이 없습니다.</p>
                                </div>
                            </div>
                        </div>
                        
                        <div class="bg-orange-50 rounded-lg p-3 border border-orange-200">
                            <p class="text-orange-800 font-bold mb-1"><i class="fa-solid fa-exclamation-triangle mr-1"></i>중요</p>
                            <p class="text-sm mb-2">• <strong>이 탭만 숫자 직접 입력 방식입니다!</strong> 나머지 탭(전담 교사, 학급 시간표)은 모두 버튼 클릭 방식입니다.</p>
                            <p class="text-sm">• 시설 시간표를 먼저 작성해야 전담 교사와 학급 시간표 작성 시 자동으로 충돌을 방지할 수 있습니다.</p>
                        </div>
                        
                        <div class="bg-orange-50 rounded-lg p-3 border border-orange-200">
                            <p class="text-orange-800 font-bold mb-1"><i class="fa-solid fa-arrow-right mr-1"></i>다음 단계</p>
                            <p class="text-sm">시설 시간표 작성이 완료되면, 상단의 <strong>"2. 교과전담 교사별 시간표"</strong> 탭으로 이동하세요.</p>
                        </div>
                    </div>
                </div>

                <div class="grid grid-cols-1 lg:grid-cols-2 gap-6" id="facility-timetables-container">
                    <!-- 동적으로 생성됨 -->
                </div>
            </div>

            <!-- TAB 2: 교과전담 교사 시간표 -->
            <div id="tab2" class="hidden space-y-6">
                <!-- 사용 안내 -->
                <div class="bg-gradient-to-r from-purple-50 to-pink-50 border border-purple-200 rounded-lg p-4">
                    <div class="flex items-center justify-between cursor-pointer" onclick="toggleHelp('help-tab2')">
                        <div class="flex items-center gap-2">
                            <i class="fa-solid fa-circle-info text-purple-600 text-xl"></i>
                            <h3 class="font-bold text-purple-900">📘 사용 방법 (클릭하여 펼치기)</h3>
                        </div>
                        <i id="help-tab2-icon" class="fa-solid fa-chevron-down text-purple-600"></i>
                    </div>
                    <div id="help-tab2" class="hidden mt-3 pt-3 border-t border-purple-200 text-sm text-gray-700 space-y-3">
                        <p><strong class="text-purple-700 text-base">📌 이 탭의 목적:</strong> 전담 교사를 추가하고 담당 과목과 시간표를 작성합니다. 시설 시간표에 배정된 시간은 자동으로 차단됩니다.</p>
                        
                        <div class="bg-white rounded-lg p-4 border border-purple-100 space-y-3">
                            <div>
                                <p class="font-bold text-purple-800 mb-2">👥 전담 교사 설정 (0번 탭에서 먼저 설정)</p>
                                <div class="pl-4 text-sm space-y-1">
                                    <p>• 0번 탭의 "6. 전담 교사 설정"에서 인원 수, 이름, 목표 시수를 설정하세요.</p>
                                    <p>• 설정한 교사들이 이 탭에 자동으로 표시됩니다.</p>
                                </div>
                            </div>
                            
                            <div>
                                <p class="font-bold text-purple-800 mb-2">📋 1단계: 과목 배정하기</p>
                                <div class="pl-4 text-sm space-y-2">
                                    <p><strong>과목 배정 버튼 클릭:</strong> 각 교사 카드 하단의 "배정할 과목 클릭" 섹션에서 버튼을 클릭하세요.</p>
                                    <div class="bg-gray-50 p-2 rounded space-y-1">
                                        <p>• <strong>예시:</strong> "4-1 영어 (2h)" 버튼 클릭 → 4학년 1반 영어 2시간 배정</p>
                                        <p>• <strong>배정 완료:</strong> 배정된 과목은 회색으로 표시되고 ✓ 표시가 나타납니다.</p>
                                        <p>• <strong>배정 해제:</strong> 같은 버튼을 다시 클릭하면 배정이 해제됩니다.</p>
                                    </div>
                                    <p>• <strong>목표 시수 확인:</strong> 교사 카드 상단에서 현재 시수/목표 시수를 확인하세요.</p>
                                    <p class="text-xs text-purple-600">💡 목표 시수에 도달하면 초록색으로 표시됩니다.</p>
                                </div>
                            </div>
                            
                            <div>
                                <p class="font-bold text-purple-800 mb-2">📅 2단계: 시간표 작성하기</p>
                                <div class="pl-4 text-sm space-y-2">
                                    <p><strong>1. 시간표 모달 열기:</strong> 교사 카드의 <strong>"시간표"</strong> 버튼을 클릭하세요.</p>
                                    <p><strong>2. 반-과목 선택:</strong> 모달 오른쪽의 <strong>"담당 반"</strong> 섹션에서 배정한 반-과목 버튼을 클릭하세요.</p>
                                    <div class="bg-gray-50 p-2 rounded space-y-1">
                                        <p>• <strong>예시:</strong> "4-1 영어" 버튼 클릭 → 보라색 테두리가 나타나면 선택 완료</p>
                                        <p>• <strong>시수 확인:</strong> 각 버튼에 "현재/목표" 시수가 표시됩니다. (예: 0/2)</p>
                                        <p>• <strong>완료 표시:</strong> 목표 시수에 도달하면 초록색으로 표시됩니다.</p>
                                    </div>
                                    <p><strong>3. 시간표 셀에 배정:</strong> 선택한 반-과목이 활성화된 상태에서 시간표의 셀을 클릭하세요.</p>
                                    <div class="bg-gray-50 p-2 rounded space-y-1">
                                        <p>• <strong>예시:</strong> "4-1 영어" 선택 → 월요일 1교시 셀 클릭 → "4-1(영어)" 입력됨</p>
                                        <p>• <strong>자동 차단:</strong> 시설에 배정된 시간은 클릭해도 입력되지 않습니다.</p>
                                        <p>• <strong>중복 방지:</strong> 같은 시간에 다른 교사에게 배정된 반은 입력할 수 없습니다.</p>
                                    </div>
                                    <p><strong>4. 시수 확인:</strong> 오른쪽 팔레트에서 각 반-과목의 현재/목표 시수를 확인하세요.</p>
                                    <p><strong>5. 완료:</strong> 모든 반-과목의 목표 시수를 채우면 완료입니다.</p>
                                </div>
                            </div>
                            
                            <div>
                                <p class="font-bold text-purple-800 mb-2">🗑️ 삭제 방법</p>
                                <div class="pl-4 text-sm space-y-1">
                                    <p>• <strong>방법 1:</strong> 시간표 셀을 클릭하면 해당 셀의 내용이 삭제됩니다.</p>
                                    <p>• <strong>방법 2:</strong> 셀을 선택하고 Delete 키 또는 Backspace 키를 누르세요.</p>
                                    <p>• <strong>과목 배정 해제:</strong> 교사 카드의 과목 배정 버튼을 다시 클릭하면 배정이 해제됩니다.</p>
                                </div>
                            </div>
                            
                            <div>
                                <p class="font-bold text-purple-800 mb-2">⭐ 특수부장 지원 과목</p>
                                <div class="pl-4 text-sm space-y-1">
                                    <p>• 특정 학급에만 적용되는 특수 과목을 추가할 수 있습니다.</p>
                                    <p>• 학년 → 반 → 과목 → 시수를 선택하고 "추가" 버튼을 클릭하세요.</p>
                                    <p>• 추가된 특수 과목은 ⭐ 표시와 함께 과목 배정 목록에 나타납니다.</p>
                                </div>
                            </div>
                            
                            <div>
                                <p class="font-bold text-purple-800 mb-2">💾 저장 및 완료</p>
                                <div class="pl-4 text-sm space-y-1">
                                    <p>• <strong>완료 체크:</strong> 시간표가 완성되면 교사 카드의 "완료" 체크박스를 선택하세요.</p>
                                    <p>• <strong>개별 저장:</strong> "완료" 체크 후 "저장" 버튼이 활성화되면 클릭하여 엑셀 파일로 다운로드하세요.</p>
                                    <p>• <strong>전체 저장:</strong> 모든 전담 교사가 완료되면 "전체 전담 시간표" 버튼으로 한 번에 저장할 수 있습니다.</p>
                                </div>
                            </div>
                        </div>
                        
                        <div class="bg-purple-50 rounded-lg p-3 border border-purple-200">
                            <p class="text-purple-800 font-bold mb-1"><i class="fa-solid fa-exclamation-triangle mr-1"></i>주의사항</p>
                            <p class="text-sm mb-2">• <strong>버튼 클릭 방식:</strong> 시설 시간표와 달리 여기서는 숫자 직접 입력이 아닌 버튼 클릭 방식입니다!</p>
                            <p class="text-sm mb-2">• <strong>격주 입력 불가:</strong> 한 셀에 하나의 반만 배정할 수 있습니다. (시설 시간표만 격주 가능)</p>
                            <p class="text-sm">• <strong>시설 충돌:</strong> 시설 시간표에 배정된 시간은 자동으로 차단되므로 입력할 수 없습니다.</p>
                        </div>
                        
                        <div class="bg-purple-50 rounded-lg p-3 border border-purple-200">
                            <p class="text-purple-800 font-bold mb-1"><i class="fa-solid fa-arrow-right mr-1"></i>다음 단계</p>
                            <p class="text-sm">모든 전담 교사 시간표가 완료되면, 상단의 <strong>"3. 학급 시간표"</strong> 탭으로 이동하세요.</p>
                        </div>
                    </div>
                </div>

                <!-- 전담 교사 완료 현황판 -->
                <div class="card bg-gradient-to-r from-blue-50 to-indigo-50 border-blue-200">
                    <div class="flex justify-between items-center mb-3">
                        <h2 class="text-lg font-bold text-indigo-900 flex items-center">
                            <i class="fa-solid fa-clipboard-check text-blue-500 mr-2"></i>전담 교사 시간표 완료 현황
                        </h2>
                        <div id="teacher-completion-summary" class="text-sm font-bold"></div>
                    </div>
                    <div id="teacher-completion-panel" class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-2"></div>
                </div>

                <!-- 특수부장 지원 과목 설정 -->
                <div class="card">
                    <h2 class="text-lg font-bold text-gray-800 mb-4 flex items-center">
                        <i class="fa-solid fa-star text-yellow-500 mr-2"></i>특수부장 지원 과목 설정
                    </h2>
                    <p class="text-sm text-gray-500 mb-3">특수부장이 담당하는 추가 과목을 설정하세요. (학년-반-과목-시수)</p>
                    <div class="flex flex-wrap gap-2 mb-3" id="special-support-list"></div>
                    <div class="flex gap-2 items-center flex-wrap">
                        <select id="special-grade-sel" class="border rounded p-2 text-sm" onchange="updateSpecialClassOptions()">
                            <option value="">학년</option>
                            <option value="3">3학년</option>
                            <option value="4">4학년</option>
                            <option value="5">5학년</option>
                            <option value="6">6학년</option>
                        </select>
                        <select id="special-class-sel" class="border rounded p-2 text-sm">
                            <option value="">반</option>
                        </select>
                        <select id="special-subj-sel" class="border rounded p-2 text-sm">
                            <option value="">과목</option>
                        </select>
                        <input id="special-hrs-input" type="number" min="0.5" step="0.5" value="1" class="border rounded p-2 text-sm w-16 text-center" placeholder="시수">
                        <button onclick="addSpecialSupport()" class="bg-yellow-500 text-white px-3 py-2 rounded text-sm hover:bg-yellow-600">
                            <i class="fa-solid fa-plus mr-1"></i>추가
                        </button>
                    </div>
                </div>

                <!-- 전담 교사 설정 -->
                <div class="card bg-indigo-50 border-indigo-200">
                    <div class="flex flex-wrap justify-between items-center gap-4 mb-4">
                        <div>
                            <h2 class="text-lg font-bold text-indigo-900">전담 교사 과목 배정</h2>
                            <p class="text-sm text-indigo-700">학년 → 과목 → 담당 반을 선택하세요. (목표: 주 21시간)</p>
                        </div>
                        <div class="flex gap-2">
                            <button id="all-teachers-excel-btn" onclick="generateAllTeachersExcel()" disabled
                                    class="bg-blue-500 text-white px-4 py-2 rounded text-sm font-bold hover:bg-blue-600 disabled:bg-gray-300 disabled:cursor-not-allowed">
                                <i class="fa-solid fa-file-excel mr-1"></i>전체 전담 시간표
                            </button>
                        <button onclick="addTeacher()" class="bg-white border border-indigo-300 text-indigo-700 px-3 py-1.5 rounded text-sm hover:bg-indigo-100 font-bold shadow-sm">
                            <i class="fa-solid fa-user-plus mr-1"></i>교사 추가
                        </button>
                        </div>
                    </div>
                    <div id="teacher-setup-list" class="space-y-4"></div>
                </div>

            </div>

            <!-- TAB 3: 학급 시간표 -->
            <div id="tab3" class="hidden space-y-6">
                <!-- 사용 안내 -->
                <div class="bg-gradient-to-r from-green-50 to-teal-50 border border-green-200 rounded-lg p-4">
                    <div class="flex items-center justify-between cursor-pointer" onclick="toggleHelp('help-tab3')">
                        <div class="flex items-center gap-2">
                            <i class="fa-solid fa-circle-info text-green-600 text-xl"></i>
                            <h3 class="font-bold text-green-900">📘 사용 방법 (클릭하여 펼치기)</h3>
                        </div>
                        <i id="help-tab3-icon" class="fa-solid fa-chevron-down text-green-600"></i>
                    </div>
                    <div id="help-tab3" class="hidden mt-3 pt-3 border-t border-green-200 text-sm text-gray-700 space-y-3">
                        <p><strong class="text-green-700 text-base">📌 이 탭의 목적:</strong> 학급별로 담임 교사가 담당할 시간표를 작성합니다. 시설과 전담 교사에 배정된 시간은 자동으로 차단됩니다.</p>
                        
                        <div class="bg-red-50 rounded-lg p-3 border-2 border-red-200">
                            <p class="text-red-700 font-bold mb-1"><i class="fa-solid fa-exclamation-triangle mr-1"></i>⚠️ 필수 조건</p>
                            <p class="text-sm">모든 전담 교사 시간표가 완료되어야 이 탭에서 학급 시간표를 작성할 수 있습니다!</p>
                            <p class="text-xs text-red-600 mt-1">→ 2번 탭에서 모든 전담 교사의 "완료" 체크박스를 선택해야 합니다.</p>
                        </div>
                        
                        <div class="bg-white rounded-lg p-4 border border-green-100 space-y-3">
                            <div>
                                <p class="font-bold text-green-800 mb-2">📋 1단계: 학급 선택</p>
                                <div class="pl-4 text-sm space-y-1">
                                    <p>• 상단의 <strong>학년</strong> 드롭다운에서 학년을 선택하세요. (예: 4학년)</p>
                                    <p>• <strong>반</strong> 드롭다운에서 반을 선택하세요. (예: 1반)</p>
                                    <p>• 선택한 학급의 시간표가 표시됩니다.</p>
                                </div>
                            </div>
                            
                            <div>
                                <p class="font-bold text-green-800 mb-2">🎨 2단계: 과목 선택하기</p>
                                <div class="pl-4 text-sm space-y-2">
                                    <p>• 오른쪽 <strong>"과목 팔레트"</strong>에서 과목 버튼을 클릭하세요.</p>
                                    <div class="bg-gray-50 p-2 rounded space-y-1">
                                        <p>• <strong>분홍색 섹션 (전담 과목):</strong> 전담 교사가 담당하는 과목입니다. 우선적으로 배정하세요.</p>
                                        <p>• <strong>회색 섹션 (담임 과목):</strong> 담임 교사가 담당하는 과목입니다.</p>
                                        <p>• 각 과목 버튼에 <strong>"현재/목표"</strong> 시수가 표시됩니다. (예: 2/5)</p>
                                        <p>• 목표 시수에 도달하면 초록색으로 표시됩니다.</p>
                                    </div>
                                    <p>• 과목을 클릭하면 선택되며, 다시 클릭하면 선택이 해제됩니다.</p>
                                </div>
                            </div>
                            
                            <div>
                                <p class="font-bold text-green-800 mb-2">📅 3단계: 시간표에 과목 배정하기</p>
                                <div class="pl-4 text-sm space-y-2">
                                    <p><strong>1. 과목 선택:</strong> 팔레트에서 과목 버튼을 클릭하여 선택하세요.</p>
                                    <p><strong>2. 셀 클릭:</strong> 선택한 과목이 활성화된 상태에서 시간표의 셀을 클릭하세요.</p>
                                    <div class="bg-gray-50 p-2 rounded space-y-1">
                                        <p>• <strong>예시:</strong> "국어" 선택 → 월요일 1교시 셀 클릭 → "국어" 입력됨</p>
                                        <p>• <strong>자동 차단:</strong> 다음 셀들은 자동으로 입력 불가 상태입니다:</p>
                                        <div class="pl-4 space-y-1">
                                            <p>- 시설에 배정된 시간 (예: 체육(강당), 국어(도서관))</p>
                                            <p>- 전담 교사가 배정된 시간 (파란색으로 표시)</p>
                                            <p>- 이미 입력된 셀 (다시 클릭하면 삭제됨)</p>
                                        </div>
                                    </div>
                                    <p><strong>3. 시수 확인:</strong> 팔레트에서 각 과목의 현재/목표 시수를 확인하세요.</p>
                                    <p><strong>4. 반복:</strong> 모든 과목의 목표 시수를 채울 때까지 반복하세요.</p>
                                </div>
                            </div>
                            
                            <div>
                                <p class="font-bold text-green-800 mb-2">🗑️ 삭제 방법</p>
                                <div class="pl-4 text-sm space-y-1">
                                    <p>• <strong>방법 1:</strong> 이미 입력된 셀을 다시 클릭하면 삭제됩니다.</p>
                                    <p>• <strong>방법 2:</strong> 셀을 선택하고 Delete 키 또는 Backspace 키를 누르세요.</p>
                                    <p class="text-xs text-red-600">⚠️ 시설이나 전담 교사에 배정된 시간은 삭제할 수 없습니다.</p>
                                </div>
                            </div>
                            
                            <div>
                                <p class="font-bold text-green-800 mb-2">✨ 자동 채우기 기능</p>
                                <div class="pl-4 text-sm space-y-1">
                                    <p>• <strong>"자동채우기"</strong> 버튼을 클릭하면 남은 시간에 담임 과목을 자동으로 배정합니다.</p>
                                    <p>• 전담 과목은 자동 채우기에 포함되지 않습니다.</p>
                                    <p>• 시설과 전담 교사 시간은 자동으로 건너뜁니다.</p>
                                </div>
                            </div>
                            
                            <div>
                                <p class="font-bold text-green-800 mb-2">💾 저장 및 완료</p>
                                <div class="pl-4 text-sm space-y-1">
                                    <p>• <strong>완료 체크:</strong> 시간표가 완성되면 상단의 <strong>"완료"</strong> 체크박스를 선택하세요.</p>
                                    <p>• <strong>저장:</strong> "완료" 체크 후 <strong>"저장"</strong> 버튼이 활성화되면 클릭하여 엑셀 파일로 다운로드하세요.</p>
                                    <p>• 저장된 파일 이름: <code class="bg-white px-1 rounded">4학년1반_시간표_2024-01-01.xlsx</code></p>
                                </div>
                            </div>
                            
                            <div>
                                <p class="font-bold text-green-800 mb-2">📊 완료 현황 확인</p>
                                <div class="pl-4 text-sm space-y-1">
                                    <p>• 하단의 <strong>"학급 시간표 완료 현황"</strong>에서 모든 학급의 완료 상태를 확인할 수 있습니다.</p>
                                    <p>• 학년별로 그룹화되어 표시됩니다.</p>
                                </div>
                            </div>
                        </div>
                        
                        <div class="bg-green-50 rounded-lg p-3 border border-green-200">
                            <p class="text-green-800 font-bold mb-1"><i class="fa-solid fa-exclamation-triangle mr-1"></i>주의사항</p>
                            <p class="text-sm mb-2">• <strong>버튼 클릭 방식:</strong> 시설 시간표와 달리 여기서는 숫자 직접 입력이 아닌 버튼 클릭 방식입니다!</p>
                            <p class="text-sm mb-2">• <strong>격주 입력 불가:</strong> 한 셀에 하나의 과목만 배정할 수 있습니다. (시설 시간표만 격주 가능)</p>
                            <p class="text-sm mb-2">• <strong>자동 차단:</strong> 시설과 전담 교사에 배정된 시간은 자동으로 차단되므로 입력할 수 없습니다.</p>
                            <p class="text-sm">• <strong>목표 시수:</strong> 각 과목의 목표 시수를 초과하여 배정할 수 없습니다.</p>
                        </div>
                        
                        <div class="bg-green-50 rounded-lg p-3 border border-green-200">
                            <p class="text-green-800 font-bold mb-1"><i class="fa-solid fa-file-excel mr-1"></i>최종 엑셀 생성</p>
                            <p class="text-sm mb-2">모든 전담 교사와 학급 시간표가 완료되면, 하단의 <strong>"전교 기준 시간표 생성"</strong> 버튼이 활성화됩니다.</p>
                            <p class="text-sm">이 버튼을 클릭하면 모든 학급의 시간표가 포함된 통합 엑셀 파일을 다운로드할 수 있습니다.</p>
                        </div>
                    </div>
                </div>

                <div class="grid grid-cols-1 lg:grid-cols-4 gap-6 h-full">
                    <div class="lg:col-span-3 flex flex-col gap-4">
                        <div class="card flex-1 flex flex-col">
                            <div class="flex justify-between items-center mb-4">
                                <div class="flex items-center gap-3">
                                    <h2 class="text-lg font-bold text-gray-800">📅 학급 시간표</h2>
                                    <select id="editor-grade-select" onchange="onEditorGradeChange()" class="border-2 border-indigo-200 rounded px-2 py-1 text-sm font-bold text-indigo-700 outline-none focus:border-indigo-500">
                                        <option value="1학년">1학년</option>
                                        <option value="2학년">2학년</option>
                                        <option value="3학년">3학년</option>
                                        <option value="4학년">4학년</option>
                                        <option value="5학년">5학년</option>
                                        <option value="6학년">6학년</option>
                                    </select>
                                    <select id="editor-class-select" onchange="onEditorClassChange()" class="border-2 border-indigo-200 rounded px-3 py-1 text-lg font-bold text-indigo-700 outline-none focus:border-indigo-500"></select>
                                    <label id="class-completion-checkbox" class="flex items-center cursor-pointer bg-green-50 border border-green-300 px-3 py-1 rounded text-sm hover:bg-green-100 ml-2">
                                        <input type="checkbox" onchange="toggleClassCompletion()" class="mr-2" id="current-class-completed">
                                        <span class="text-green-700 font-bold">완료</span>
                                    </label>
                                </div>
                                <div class="space-x-2">
                                    <button onclick="resetClassTimetable()" class="bg-gray-100 text-gray-600 px-3 py-1.5 rounded text-sm font-bold hover:bg-gray-200"><i class="fa-solid fa-rotate-left mr-1"></i>초기화</button>
                                    <button onclick="autoFill()" class="bg-pink-100 text-pink-700 px-3 py-1.5 rounded text-sm font-bold hover:bg-pink-200"><i class="fa-solid fa-magic mr-1"></i>자동채우기</button>
                                    <button id="class-save-btn" onclick="downloadExcel()" disabled class="bg-green-600 text-white px-3 py-1.5 rounded text-sm font-bold hover:bg-green-700 disabled:bg-gray-300 disabled:cursor-not-allowed"><i class="fa-solid fa-file-excel mr-1"></i>저장</button>
                                </div>
                            </div>
                            <div class="flex-1 border rounded-lg overflow-hidden">
                                <table class="base-table w-full" style="table-layout: fixed;">
                                    <thead>
                                        <tr class="bg-gray-100">
                                            <th class="w-16 h-10">교시</th>
                                            <th class="h-10">월</th>
                                            <th class="h-10">화</th>
                                            <th class="h-10">수</th>
                                            <th class="h-10">목</th>
                                            <th class="h-10">금</th>
                                        </tr>
                                    </thead>
                                    <tbody id="editor-grid-body"></tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                    <div class="lg:col-span-1">
                        <div class="card h-full flex flex-col sticky top-0">
                            <h3 class="font-bold text-gray-800 mb-4 border-b pb-2">🎨 과목 팔레트</h3>
                            <div class="flex-1 overflow-y-auto pr-2 space-y-6">
                                <div><h4 class="text-xs font-bold text-pink-600 mb-2 uppercase flex justify-between">전담 과목 (우선) <i class="fa-solid fa-star"></i></h4><div id="palette-jeondam" class="space-y-1"></div></div>
                                <div><h4 class="text-xs font-bold text-gray-600 mb-2 uppercase">담임 과목 (나머지)</h4><div id="palette-damim" class="space-y-1"></div></div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- 학급 시간표 완료 현황판 (맨 아래로 이동) -->
                <div class="card bg-gradient-to-r from-green-50 to-emerald-50 border-green-200">
                    <div class="flex justify-between items-center mb-3">
                        <h2 class="text-lg font-bold text-emerald-900 flex items-center">
                            <i class="fa-solid fa-clipboard-check text-green-500 mr-2"></i>학급 시간표 완료 현황
                        </h2>
                        <div id="class-completion-summary" class="text-sm font-bold"></div>
                    </div>
                    <div id="class-completion-panel" class="space-y-2"></div>
                </div>

                <!-- 최종 엑셀 생성 버튼 (맨 아래로 이동) -->
                <div class="card bg-gradient-to-r from-purple-50 to-pink-50 border-purple-200">
                    <div class="flex justify-between items-center">
                        <div>
                            <h2 class="text-lg font-bold text-purple-900 flex items-center mb-2">
                                <i class="fa-solid fa-file-excel text-purple-500 mr-2"></i>최종 엑셀 생성
                            </h2>
                            <p class="text-sm text-purple-700">모든 전담 교사와 학급 시간표가 완료되면 전교 기준 시간표를 엑셀로 다운로드할 수 있습니다.</p>
                        </div>
                        <button id="final-excel-btn" onclick="generateFinalExcel()" disabled 
                                class="bg-purple-500 text-white px-6 py-3 rounded-lg text-lg font-bold hover:bg-purple-600 disabled:bg-gray-300 disabled:cursor-not-allowed shadow-lg">
                            <i class="fa-solid fa-download mr-2"></i>전교 기준 시간표 생성
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- JavaScript Files -->
    <script src="js/state.js"></script>
    <script src="js/utils.js"></script>
    <script src="js/firebase.js"></script>
    <script src="js/auth.js"></script>
    <script src="js/tab0.js"></script>
    <script src="js/tab1.js"></script>
    <script src="js/tab2.js"></script>
    <script src="js/tab3.js"></script>
    <script src="js/teacher-excel.js"></script>
    <script src="js/excel.js"></script>
    <script src="js/app.js"></script>
</body>
</html>
